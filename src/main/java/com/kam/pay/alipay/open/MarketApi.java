package com.kam.pay.alipay.open;import com.alipay.easysdk.factory.Factory;import com.alipay.easysdk.marketing.openlife.models.AlipayOpenPublicLifeMsgRecallResponse;import com.alipay.easysdk.marketing.openlife.models.AlipayOpenPublicMessageContentCreateResponse;import com.alipay.easysdk.marketing.openlife.models.AlipayOpenPublicMessageContentModifyResponse;import com.alipay.easysdk.marketing.openlife.models.AlipayOpenPublicMessageSingleSendResponse;import com.alipay.easysdk.marketing.openlife.models.AlipayOpenPublicMessageTotalSendResponse;import com.alipay.easysdk.marketing.openlife.models.AlipayOpenPublicSettingCategoryQueryResponse;import com.alipay.easysdk.marketing.openlife.models.AlipayOpenPublicTemplateMessageIndustryModifyResponse;import com.alipay.easysdk.marketing.openlife.models.Article;import com.alipay.easysdk.marketing.openlife.models.Context;import com.alipay.easysdk.marketing.openlife.models.Template;import com.google.common.collect.Lists;import com.kam.pay.alipay.consts.AliPayConsts;import org.apache.commons.collections.CollectionUtils;import org.apache.commons.lang3.StringUtils;import org.slf4j.Logger;import org.slf4j.LoggerFactory;import java.util.List;/** * 营销能力 */public class MarketApi {    private static final Logger logger = LoggerFactory.getLogger(MarketApi.class);    // ----------------------------- 生活号 OpenLife -----------------------------    /**     * 创建图文消息内容     *     * @param title   [必填] 标题     * @param cover   [必填] 封面图URL, 尺寸为996*450，最大不超过3M，支持.jpg、.png格式，请先调用上传图片接口获得图片URL     * @param content [必填] 消息正文（支持富文本）     * @return     */    public static AlipayOpenPublicMessageContentCreateResponse createImageTextContent(String title, String cover, String content) throws Exception {        return createImageTextContent(title, cover, content, null);    }    /**     * 创建图文消息内容     *     * @param title                   [必填] 标题     * @param cover                   [必填] 封面图URL, 尺寸为996*450，最大不超过3M，支持.jpg、.png格式，请先调用上传图片接口获得图片URL     * @param content                 [必填] 消息正文（支持富文本）     * @param allowContentCommentEnum 是否允许评论，T：允许，F：不允许，默认不允许 {@link AliPayConsts.AllowContentCommentEnum}     * @return     */    public static AlipayOpenPublicMessageContentCreateResponse createImageTextContent(String title, String cover, String content, AliPayConsts.AllowContentCommentEnum allowContentCommentEnum) throws Exception {        return createImageTextContent(title, cover, content, allowContentCommentEnum, StringUtils.EMPTY);    }    /**     * 创建图文消息内容     *     * @param title                   [必填] 标题     * @param cover                   [必填] 封面图URL, 尺寸为996*450，最大不超过3M，支持.jpg、.png格式，请先调用上传图片接口获得图片URL     * @param content                 [必填] 消息正文（支持富文本）     * @param allowContentCommentEnum 是否允许评论，T：允许，F：不允许，默认不允许 {@link AliPayConsts.AllowContentCommentEnum}     * @param ctype                   填activity表示活动图文，不填默认普通图文     * @return     */    public static AlipayOpenPublicMessageContentCreateResponse createImageTextContent(String title, String cover, String content, AliPayConsts.AllowContentCommentEnum allowContentCommentEnum, String ctype) throws Exception {        return createImageTextContent(title, cover, content, allowContentCommentEnum, ctype, StringUtils.EMPTY);    }    /**     * 创建图文消息内容     *     * @param title                   [必填] 标题     * @param cover                   [必填] 封面图URL, 尺寸为996*450，最大不超过3M，支持.jpg、.png格式，请先调用上传图片接口获得图片URL     * @param content                 [必填] 消息正文（支持富文本）     * @param allowContentCommentEnum 是否允许评论，T：允许，F：不允许，默认不允许 {@link AliPayConsts.AllowContentCommentEnum}     * @param ctype                   填activity表示活动图文，不填默认普通图文     * @param benefit                 图文类型ctype为activity类型时才需要传，最多10个字符     * @return     */    public static AlipayOpenPublicMessageContentCreateResponse createImageTextContent(String title, String cover, String content, AliPayConsts.AllowContentCommentEnum allowContentCommentEnum, String ctype, String benefit) throws Exception {        return createImageTextContent(title, cover, content, allowContentCommentEnum, ctype, benefit, StringUtils.EMPTY);    }    /**     * 创建图文消息内容     *     * @param title                   [必填] 标题     * @param cover                   [必填] 封面图URL, 尺寸为996*450，最大不超过3M，支持.jpg、.png格式，请先调用上传图片接口获得图片URL     * @param content                 [必填] 消息正文（支持富文本）     * @param allowContentCommentEnum 是否允许评论，T：允许，F：不允许，默认不允许 {@link AliPayConsts.AllowContentCommentEnum}     * @param ctype                   填activity表示活动图文，不填默认普通图文     * @param benefit                 图文类型ctype为activity类型时才需要传，最多10个字符     * @param extTags                 英文逗号分隔，最多不超过5个     * @return     */    public static AlipayOpenPublicMessageContentCreateResponse createImageTextContent(String title, String cover, String content, AliPayConsts.AllowContentCommentEnum allowContentCommentEnum, String ctype, String benefit, String extTags) throws Exception {        return createImageTextContent(title, cover, content, allowContentCommentEnum, ctype, benefit, extTags, StringUtils.EMPTY);    }    /**     * 创建图文消息内容     *     * @param title                   [必填] 标题     * @param cover                   [必填] 封面图URL, 尺寸为996*450，最大不超过3M，支持.jpg、.png格式，请先调用上传图片接口获得图片URL     * @param content                 [必填] 消息正文（支持富文本）     * @param allowContentCommentEnum 是否允许评论，T：允许，F：不允许，默认不允许 {@link AliPayConsts.AllowContentCommentEnum}     * @param ctype                   填activity表示活动图文，不填默认普通图文     * @param benefit                 图文类型ctype为activity类型时才需要传，最多10个字符     * @param extTags                 英文逗号分隔，最多不超过5个     * @param loginIds                可预览支付宝账号列表，需要预览时才填写，英文逗号分隔，最多不超过10个     * @return     */    public static AlipayOpenPublicMessageContentCreateResponse createImageTextContent(String title, String cover, String content, AliPayConsts.AllowContentCommentEnum allowContentCommentEnum, String ctype, String benefit, String extTags, String loginIds) throws Exception {        if (allowContentCommentEnum == null) {            allowContentCommentEnum = AliPayConsts.AllowContentCommentEnum.F;        }        return Factory.Marketing.OpenLife().createImageTextContent(title, cover, content, allowContentCommentEnum.getContentComment(), ctype, benefit, extTags, loginIds);    }    /**     * 更新图文消息内容     *     * @param contentId [必填] 内容ID，通过创建图文内容消息接口返回     * @param title     [必填] 标题     * @param cover     [必填] 封面图URL, 尺寸为996*450，最大不超过3M，支持.jpg、.png格式，请先调用上传图片接口获得图片URL     * @param content   [必填] 消息正文（支持富文本）     * @return     */    public static AlipayOpenPublicMessageContentModifyResponse modifyImageTextContent(String contentId, String title, String cover, String content) throws Exception {        return modifyImageTextContent(contentId, title, cover, content, null);    }    /**     * 更新图文消息内容     *     * @param contentId               [必填] 内容ID，通过创建图文内容消息接口返回     * @param title                   [必填] 标题     * @param cover                   [必填] 封面图URL, 尺寸为996*450，最大不超过3M，支持.jpg、.png格式，请先调用上传图片接口获得图片URL     * @param content                 [必填] 消息正文（支持富文本）     * @param allowContentCommentEnum 是否允许评论，T：允许，F：不允许，默认不允许 {@link AliPayConsts.AllowContentCommentEnum}     * @return     */    public static AlipayOpenPublicMessageContentModifyResponse modifyImageTextContent(String contentId, String title, String cover, String content, AliPayConsts.AllowContentCommentEnum allowContentCommentEnum) throws Exception {        return modifyImageTextContent(contentId, title, cover, content, allowContentCommentEnum, StringUtils.EMPTY);    }    /**     * 更新图文消息内容     *     * @param contentId               [必填] 内容ID，通过创建图文内容消息接口返回     * @param title                   [必填] 标题     * @param cover                   [必填] 封面图URL, 尺寸为996*450，最大不超过3M，支持.jpg、.png格式，请先调用上传图片接口获得图片URL     * @param content                 [必填] 消息正文（支持富文本）     * @param allowContentCommentEnum 是否允许评论，T：允许，F：不允许，默认不允许 {@link AliPayConsts.AllowContentCommentEnum}     * @param ctype                   填activity表示活动图文，不填默认普通图文     * @return     */    public static AlipayOpenPublicMessageContentModifyResponse modifyImageTextContent(String contentId, String title, String cover, String content, AliPayConsts.AllowContentCommentEnum allowContentCommentEnum, String ctype) throws Exception {        return modifyImageTextContent(contentId, title, cover, content, allowContentCommentEnum, ctype, StringUtils.EMPTY);    }    /**     * 更新图文消息内容     *     * @param contentId               [必填] 内容ID，通过创建图文内容消息接口返回     * @param title                   [必填] 标题     * @param cover                   [必填] 封面图URL, 尺寸为996*450，最大不超过3M，支持.jpg、.png格式，请先调用上传图片接口获得图片URL     * @param content                 [必填] 消息正文（支持富文本）     * @param allowContentCommentEnum 是否允许评论，T：允许，F：不允许，默认不允许 {@link AliPayConsts.AllowContentCommentEnum}     * @param ctype                   填activity表示活动图文，不填默认普通图文     * @param benefit                 图文类型ctype为activity类型时才需要传，最多10个字符     * @return     */    public static AlipayOpenPublicMessageContentModifyResponse modifyImageTextContent(String contentId, String title, String cover, String content, AliPayConsts.AllowContentCommentEnum allowContentCommentEnum, String ctype, String benefit) throws Exception {        return modifyImageTextContent(contentId, title, cover, content, allowContentCommentEnum, ctype, benefit, StringUtils.EMPTY);    }    /**     * 更新图文消息内容     *     * @param contentId               [必填] 内容ID，通过创建图文内容消息接口返回     * @param title                   [必填] 标题     * @param cover                   [必填] 封面图URL, 尺寸为996*450，最大不超过3M，支持.jpg、.png格式，请先调用上传图片接口获得图片URL     * @param content                 [必填] 消息正文（支持富文本）     * @param allowContentCommentEnum 是否允许评论，T：允许，F：不允许，默认不允许 {@link AliPayConsts.AllowContentCommentEnum}     * @param ctype                   填activity表示活动图文，不填默认普通图文     * @param benefit                 图文类型ctype为activity类型时才需要传，最多10个字符     * @param extTags                 英文逗号分隔，最多不超过5个     * @return     */    public static AlipayOpenPublicMessageContentModifyResponse modifyImageTextContent(String contentId, String title, String cover, String content, AliPayConsts.AllowContentCommentEnum allowContentCommentEnum, String ctype, String benefit, String extTags) throws Exception {        return modifyImageTextContent(contentId, title, cover, content, allowContentCommentEnum, ctype, benefit, extTags, StringUtils.EMPTY);    }    /**     * 更新图文消息内容     *     * @param contentId               [必填] 内容ID，通过创建图文内容消息接口返回     * @param title                   [必填] 标题     * @param cover                   [必填] 封面图URL, 尺寸为996*450，最大不超过3M，支持.jpg、.png格式，请先调用上传图片接口获得图片URL     * @param content                 [必填] 消息正文（支持富文本）     * @param allowContentCommentEnum 是否允许评论，T：允许，F：不允许，默认不允许 {@link AliPayConsts.AllowContentCommentEnum}     * @param ctype                   填activity表示活动图文，不填默认普通图文     * @param benefit                 图文类型ctype为activity类型时才需要传，最多10个字符     * @param extTags                 英文逗号分隔，最多不超过5个     * @param loginIds                可预览支付宝账号列表，需要预览时才填写，英文逗号分隔，最多不超过10个     * @return     */    public static AlipayOpenPublicMessageContentModifyResponse modifyImageTextContent(String contentId, String title, String cover, String content, AliPayConsts.AllowContentCommentEnum allowContentCommentEnum, String ctype, String benefit, String extTags, String loginIds) throws Exception {        if (allowContentCommentEnum == null) {            allowContentCommentEnum = AliPayConsts.AllowContentCommentEnum.F;        }        return Factory.Marketing.OpenLife().modifyImageTextContent(contentId, title, cover, content, allowContentCommentEnum.getContentComment(), ctype, benefit, extTags, loginIds);    }    /**     * 群发本文消息     *     * @param text [必填] 文本消息内容     * @return     * @throws Exception     */    public static AlipayOpenPublicMessageTotalSendResponse sendText(String text) throws Exception {        return Factory.Marketing.OpenLife().sendText(text);    }    /**     * 群发图文消息     *     * @param desc [必填] 图文消息描述     * @param url  [必填] 点击图文消息跳转的链接     * @return     * @throws Exception     */    public static AlipayOpenPublicMessageTotalSendResponse sendImageText(String desc, String url) throws Exception {        Article article = new Article();        article.setDesc(desc);        article.setUrl(url);        return sendImageText(article);    }    /**     * 群发图文消息     *     * @param title      图文消息标题     * @param desc       [必填] 图文消息描述     * @param imageUrl   图片链接，对于多条图文消息的第一条消息，该字段不能为空，请先调用上传图片接口获得图片URL     * @param url        [必填] 点击图文消息跳转的链接     * @param actionName 链接文字     * @return     * @throws Exception     */    public static AlipayOpenPublicMessageTotalSendResponse sendImageText(String title, String desc, String imageUrl, String url, String actionName) throws Exception {        Article article = new Article();        article.setTitle(title);        article.setDesc(desc);        article.setImageUrl(imageUrl);        article.setUrl(url);        article.setActionName(actionName);        return sendImageText(article);    }    /**     * 群发图文消息     *     * @param article [必填] 图文消息内容     * @return     * @throws Exception     */    public static AlipayOpenPublicMessageTotalSendResponse sendImageText(Article article) throws Exception {        return sendImageText(Lists.newArrayList(article));    }    /**     * 群发图文消息     *     * @param articles [必填] 图文消息内容     * @return     * @throws Exception     */    public static AlipayOpenPublicMessageTotalSendResponse sendImageText(List<Article> articles) throws Exception {        if (CollectionUtils.isEmpty(articles)) {            throw new Exception("[articles] 不能为空");        }        for (Article article : articles) {            article.validate();        }        return Factory.Marketing.OpenLife().sendImageText(articles);    }    /**     * 单发模板消息     *     * @param toUserId   [必填] 消息接收用户的UserId     * @param templateId [必填] 消息模板ID     * @param headColor  [必填] 顶部色条的色值，比如#85be53     * @param url        [必填] 点击消息后承接页的地址     * @param actionName [必填] 底部链接描述文字，如：“查看详情”，最多能传8个汉字或16个英文字符     * @return     */    public static AlipayOpenPublicMessageSingleSendResponse sendSingleMessage(String toUserId, String templateId, String headColor, String url, String actionName) throws Exception {        Context contex = new Context().setHeadColor(headColor).setUrl(url).setActionName(actionName);        return sendSingleMessage(toUserId, templateId, contex);    }    /**     * 单发模板消息     *     * @param toUserId   [必填] 消息接收用户的UserId     * @param templateId [必填] 消息模板ID     * @param contex     [必填] 消息模板上下文，即模板中定义的参数及参数值     * @return     */    public static AlipayOpenPublicMessageSingleSendResponse sendSingleMessage(String toUserId, String templateId, Context contex) throws Exception {        Template template = new Template().setTemplateId(templateId).setContext(contex);        return sendSingleMessage(toUserId, template);    }    /**     * 单发模板消息     *     * @param toUserId [必填] 消息接收用户的UserId     * @param template [必填] 消息模板相关参数，其中包括templateId模板ID和context模板上下文     * @return     */    public static AlipayOpenPublicMessageSingleSendResponse sendSingleMessage(String toUserId, Template template) throws Exception {        template.validate();        return Factory.Marketing.OpenLife().sendSingleMessage(toUserId, template);    }    /**     * 生活号消息撤回     *     * @param messageId 消息ID     * @return     */    public static AlipayOpenPublicLifeMsgRecallResponse recallMessage(String messageId) throws Exception {        return Factory.Marketing.OpenLife().recallMessage(messageId);    }    /**     * 模板消息行业设置     *     * @param primaryIndustryCode   服务窗消息模板所属主行业一级编码     * @param primaryIndustryName   服务窗消息模板所属主行业一级名称     * @param secondaryIndustryCode 服务窗消息模板所属主行业二级编码     * @param secondaryIndustryName 服务窗消息模板所属主行业二级名称     * @return     * @throws Exception     */    public static AlipayOpenPublicTemplateMessageIndustryModifyResponse setIndustry(String primaryIndustryCode, String primaryIndustryName, String secondaryIndustryCode, String secondaryIndustryName) throws Exception {        return Factory.Marketing.OpenLife().setIndustry(primaryIndustryCode, primaryIndustryName, secondaryIndustryCode, secondaryIndustryName);    }    /**     * 生活号查询行业设置     *     * @return     * @throws Exception     */    public static AlipayOpenPublicSettingCategoryQueryResponse getIndustry() throws Exception {        return Factory.Marketing.OpenLife().getIndustry();    }}